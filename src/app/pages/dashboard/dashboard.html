<div class="container-fluid mt-4 px-4">
  
  <div class="d-flex justify-content-between align-items-center mb-5">
    <div>
      <h2 class="fw-bold mb-0">Resumen Financiero</h2>
      <p class="text-muted-dynamic mb-0">Bienvenido de nuevo</p>
    </div>
    <a routerLink="/transactions" class="btn btn-primary shadow-sm rounded-pill px-4">
      + Nuevo Movimiento
    </a>
  </div>

  @if (summary()) {
    <div class="row g-4 mb-5">
      <div class="col-md-4">
        <div class="neo-card d-flex flex-column justify-content-center position-relative overflow-hidden">
          <div class="position-absolute top-0 bottom-0 start-0 bg-primary" style="width: 6px;"></div>
          <div class="d-flex align-items-center mb-2">
            <div class="fs-4 me-2">ðŸ’°</div>
            <span class="text-muted-dynamic fw-bold small text-uppercase">Balance Total</span>
          </div>
          <h2 class="fw-bold text-primary mb-0">
            {{ summary()!.balance | currency:'EUR' }}
          </h2>
        </div>
      </div>

      <div class="col-md-4">
        <div class="neo-card d-flex flex-column justify-content-center position-relative overflow-hidden">
          <div class="position-absolute top-0 bottom-0 start-0 bg-success" style="width: 6px;"></div>
          <div class="d-flex align-items-center mb-2">
            <div class="fs-4 me-2">ðŸ“ˆ</div>
            <span class="text-muted-dynamic fw-bold small text-uppercase">Ingresos</span>
          </div>
          <h2 class="fw-bold text-success mb-0">
            +{{ summary()!.totalIncome | currency:'EUR' }}
          </h2>
        </div>
      </div>

      <div class="col-md-4">
        <div class="neo-card d-flex flex-column justify-content-center position-relative overflow-hidden">
          <div class="position-absolute top-0 bottom-0 start-0 bg-danger" style="width: 6px;"></div>
          <div class="d-flex align-items-center mb-2">
            <div class="fs-4 me-2">ðŸ“‰</div>
            <span class="text-muted-dynamic fw-bold small text-uppercase">Gastos</span>
          </div>
          <h2 class="fw-bold text-danger mb-0">
            -{{ summary()!.totalExpense | currency:'EUR' }}
          </h2>
        </div>
      </div>
    </div>
  }

  <div class="row g-4">
    
    <div class="col-lg-8">
      <div class="neo-card">
        <h5 class="fw-bold mb-4">EvoluciÃ³n Semestral</h5>
        <div style="height: 300px; width: 100%; position: relative;">
          @if (hasHistory()) {
            <canvas baseChart 
                    [data]="barChartData()" 
                    [type]="barChartType" 
                    [options]="barChartOptions">
            </canvas>
          } @else {
            <div class="d-flex justify-content-center align-items-center h-100 text-muted-dynamic">
              Sin datos histÃ³ricos.
            </div>
          }
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="neo-card h-100">
        <h5 class="fw-bold mb-4">Por CategorÃ­a</h5>
        <div style="height: 300px; width: 100%; position: relative;">
          @if (hasCategories()) {
            <canvas baseChart 
                    [data]="doughnutChartData()" 
                    [type]="doughnutChartType" 
                    [options]="doughnutChartOptions">
            </canvas>
          } @else {
            <div class="d-flex flex-column justify-content-center align-items-center h-100 text-center px-3">
              <p class="text-muted-dynamic mb-3">No hay datos.</p>
            </div>
          }
        </div>
      </div>
    </div>
  </div>

  <div class="mt-5">
    <h5 class="fw-bold mb-3">Accesos Directos</h5>
    <div class="row g-3">
      @for (acc of accounts(); track acc.id) {
        <div class="col-md-3 col-sm-6">
          <div class="neo-card py-3 px-3 d-flex justify-content-between align-items-center" 
               (click)="goToAccount(acc.id!)" 
               style="cursor: pointer; min-height: auto;">
            <div>
              <small class="text-muted-dynamic d-block">{{ acc.name }}</small>
              <span class="fw-bold text-primary">{{ acc.currentBalance | currency:'EUR' }}</span>
            </div>
            <span class="text-muted opacity-50">â†’</span>
          </div>
        </div>
      }
    </div>
  </div>
</div>