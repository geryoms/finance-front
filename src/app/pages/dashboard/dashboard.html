<div class="container-fluid mt-4">
  <h2 class="mb-4 text-secondary">Resumen Financiero</h2>

  <div class="row g-4 mb-4" *ngIf="summary">
    <div class="col-md-4">
      <div class="card shadow-sm border-0 border-bottom border-success border-4 h-100">
        <div class="card-body d-flex align-items-center">
          <div class="fs-1 me-3">üí∞</div>
          <div><h6 class="text-muted text-uppercase mb-1">Ingresos</h6><h2 class="fw-bold text-dark mb-0">{{ summary.totalIncome | currency:'EUR' }}</h2></div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-sm border-0 border-bottom border-danger border-4 h-100">
        <div class="card-body d-flex align-items-center">
          <div class="fs-1 me-3">üí∏</div>
          <div><h6 class="text-muted text-uppercase mb-1">Gastos</h6><h2 class="fw-bold text-dark mb-0">{{ summary.totalExpense | currency:'EUR' }}</h2></div>
        </div>
      </div>
    </div>
    <div class="col-md-4">
      <div class="card shadow-sm border-0 border-bottom border-primary border-4 h-100">
        <div class="card-body d-flex align-items-center">
          <div class="fs-1 me-3">üè¶</div>
          <div><h6 class="text-muted text-uppercase mb-1">Balance Total</h6><h2 class="fw-bold text-dark mb-0">{{ summary.balance | currency:'EUR' }}</h2></div>
        </div>
      </div>
    </div>
  </div>

  <h5 class="text-secondary mb-3">Mis Cuentas</h5>
  <div class="row g-3 mb-4">
    <div class="col-md-3 col-sm-6" *ngFor="let acc of accounts">
      <div class="card shadow-sm border-0 h-100 account-card" (click)="goToAccount(acc.id!)" style="cursor: pointer; transition: transform 0.2s;">
        <div class="card-body">
          <h6 class="text-muted mb-1">{{ acc.name }}</h6>
          <h4 class="fw-bold mb-0" [class.text-success]="acc.currentBalance >= 0" [class.text-danger]="acc.currentBalance < 0">
            {{ acc.currentBalance | currency:'EUR' }}
          </h4>
          <small class="text-primary mt-2 d-block" style="font-size: 0.8rem;">Ver movimientos ‚Üí</small>
        </div>
      </div>
    </div>
    
    <div class="col-md-3 col-sm-6" *ngIf="accounts.length < 4">
      <a routerLink="/accounts" class="card shadow-sm border-0 h-100 text-decoration-none bg-light d-flex align-items-center justify-content-center text-center p-3" style="border: 2px dashed #ddd !important;">
        <span class="text-muted">‚ûï A√±adir Cuenta</span>
      </a>
    </div>
  </div>

  <div class="row g-4">
    <div class="col-lg-8">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header bg-white py-3"><h5 class="mb-0 fw-bold text-secondary">Evoluci√≥n Semestral</h5></div>
        <div class="card-body">
          <div class="chart-container" style="position: relative; height: 300px; width: 100%">
            <ng-container *ngIf="hasHistoryData; else noHistory">
              <canvas baseChart [data]="barChartData" [type]="barChartType" [options]="barChartOptions"></canvas>
            </ng-container>
            <ng-template #noHistory><div class="d-flex justify-content-center align-items-center h-100 text-muted">Sin datos hist√≥ricos suficientes.</div></ng-template>
          </div>
        </div>
      </div>
    </div>

    <div class="col-lg-4">
      <div class="card shadow-sm border-0 h-100">
        <div class="card-header bg-white py-3"><h5 class="mb-0 fw-bold text-secondary">Por Categor√≠a</h5></div>
        <div class="card-body">
          <div class="chart-container" style="position: relative; height: 300px; width: 100%">
            <ng-container *ngIf="hasChartData; else noData">
              <canvas baseChart [data]="doughnutChartData" [type]="doughnutChartType" [options]="doughnutChartOptions"></canvas>
            </ng-container>
            <ng-template #noData><div class="d-flex justify-content-center align-items-center h-100 text-muted text-center px-3">A√±ade categor√≠as a tus gastos para ver el gr√°fico.</div></ng-template>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>